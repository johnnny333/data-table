@if(dataResource.hasValue()) { @let keys = keys$();

<table aria-label="User details table">
  <caption>
    Users table
  </caption>
  <thead>
    <tr>
      @for (key of keys; track $index) {
      <th scope="col" (click)="setSortVars(key)">
        {{ key | titlecase }}
        @if(currentSortField$() === key) { ({{
          sortDirection$() === "asc" ? "↑" : "↓"
        }}) }
      </th>
      }
    </tr>
  </thead>
  <tbody>
    @for (user of visibleUsers(); track user.id) {
    <tr>
      @for (key of keys; track $index) {
      <td>
        {{ user[key] }}
      </td>
      }
    </tr>
    }
  </tbody>
  @let totalPages = totalPages$(); @let currentPage = currentPage$();
  <tfoot>
    <tr>
      <!-- TODO Extract pagination -->
      <select name="no-of-users" [(ngModel)]="pageSize$">
        <option value="5">Show 5</option>
        <option value="10">Show 10</option>
        <option value="20">Show 20</option>
      </select>
      <button
        [disabled]="currentPage === 1"
        (click)="prevPage()"
        aria-label="Previous page"
      >
        Prev
      </button>
      <span aria-current="page"
        >Page {{ currentPage }} of {{ totalPages }}</span
      >
      <button
        [disabled]="totalPages === currentPage"
        (click)="nextPage()"
        aria-label="Next page"
      >
        Next
      </button>
    </tr>
  </tfoot>
</table>

} @else if (dataResource.error()) {
<p>Could not load user information</p>
} @else if (dataResource.isLoading()) {
<p aria-live="polite" role="status">Loading user info...</p>
}
